<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>How to Internationalize a Package</title><meta name="generator" content="DocBook XSL Stylesheets V1.64.1"><link rel="home" href="index.html" title="OpenACS Core Documentation"><link rel="up" href="i18n.html" title="Chapter 14. Internationalization"><link rel="previous" href="i18n-introduction.html" title="How Internationalization/Localization works in OpenACS"><link rel="next" href="i18n-design.html" title="Design Notes"><link rel="stylesheet" href="openacs.css" type="text/css"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><a href="http://openacs.org"><img src="/doc/images/alex.jpg" border="0" alt="Alex logo"></a><table width="100%" summary="Navigation header" border="0"><tr><td width="20%" align="left"><a accesskey="p" href="i18n-introduction.html">Prev</a> </td><th width="60%" align="center">Chapter 14. Internationalization</th><td width="20%" align="right"> <a accesskey="n" href="i18n-design.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="i18n-convert"></a>How to Internationalize a Package</h2></div></div><div></div></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>
      For multilingual websites we recommend using the UTF8
      charset. In order for AOLserver to use utf8 you need to set
      the config parameters OutputCharset and
      URLCharset to utf-8 in your AOLserver config file (use the etc/config.tcl
      template file).  This is the default for OpenACS 5.1 and later. For sites running on Oracle you need to make
      sure that AOLserver is running with the NLS_LANG environment
      variable set to .UTF8. You should set this variable in the
      nsd-oracle run script (use the
      acs-core-docs/www/files/nds-oracle.txt template file).
    </p></div><div class="orderedlist"><ol type="1"><li><p><b>Replace all text with temporary message tags. </b>From<tt class="computeroutput">/acs-admin/apm/</tt>, select a
        package and then click on
        <tt class="computeroutput">Internationalization</tt>, then
        <tt class="computeroutput">Convert ADP, Tcl, and SQL files to using the
        message catalog.</tt>.  This pass only changes the adp files; it does not affect catalog files or the catalog in the database.</p><div class="mediaobject" align="center"><img src="images/i18n-1.png" align="middle"></div><p>You will now be walked through all of the selected adp pages.  The UI shows you the intended changes and lets you edit or cancel them key by key.</p><div class="mediaobject" align="center"><img src="images/i18n-2.png" align="middle"></div><div class="itemizedlist"><ul type="disc"><li><p>The automatic process can easily get confused by tags within message texts, so that it tries to create two or three message keys for one long string with a tag in the middle.  In these cases, uncheck those keys during the conversion and then edit the files directly.  For example, this code:</p><pre class="programlisting">  &lt;p class="form-help-text"&gt;&lt;b&gt;Invitations&lt;/b&gt; are sent,
    when this wizard is completed and casting begins.&lt;/p&gt;</pre><p>has a bold tag which confuses the converter into thinking there are two message keys for the text beginning "Invitations ..." where there should be one:</p><div class="mediaobject" align="center"><img src="images/i18n-3.png" align="middle"></div><p>Instead, we cancel those keys, edit the file manually, and put in a single temporary message tag:</p><pre class="programlisting">  &lt;p class="form-help-text"&gt; &lt;#Invitations_are_sent &lt;b&gt;Invitations&lt;/b&gt; are sent,
    when this wizard is completed and casting begins.#&gt;
  &lt;/p&gt;</pre></li><li><p>Complex if statements may produce convoluted message keys that are very hard to localize.  Rewrite these if statements.  For example:</p><pre class="programlisting">
Select which case &lt;if @simulation.casting_type@ eq "open"&gt;and
role&lt;/if&gt; to join, or create a new case for yourself.  If you do not
select a case &lt;if @simulation.casting_type@ eq "open"&gt;and role&lt;/if&gt;
to join, you will be automatically assigned to a case &lt;if
@simulation.casting_type@ eq "open"&gt;and role&lt;/if&gt; when the
simulation begins.</pre><p>... can be rewritten:</p><pre class="programlisting">&lt;if @simulation.casting_type@ eq "open"&gt;

Select which case and role to join, or create a new case for
yourself.  If you do not select a case and role to join, you will
be automatically assigned to a case and role when the simulation
begins.

&lt;/if&gt;
&lt;else&gt;

Select which case to join, or create a new case for
yourself.  If you do not select a case to join, you will
be automatically assigned to a case when the simulation
begins.

&lt;/else&gt;</pre></li><li><p>Check for duplicate keys.  For common words such as
            Yes and No, you can use a library of keys at <a href="/acs-lang/admin/message-list?package%5fkey=acs%2dkernel&amp;locale=en%5fUS" target="_top">acs-kernel</a>.
            For example, instead of using
            <tt class="computeroutput">myfirstpackage.Yes</tt>, you
            can use <tt class="computeroutput">acs-kernel.Yes</tt>.
            You can also use the <a href="/acs-lang/admin/package-list?locale=en%5fUS" target="_top">Message Key Search</a> facility to find duplicates.
            Be careful, however, building up sentences from keys
            because grammar and other elements may not be consistent
            across different locales.</p><p>Additional discussion: <a href="http://openacs.org/forums/message-view?message_id=164973" target="_top">Re:
            Bug 961 ("Control Panel" displayed instead of
            "Administer")</a>, <a href="http://openacs.org/forums/message-view?message_id=125235" target="_top">Translation
            server upgraded</a>, and <a href="http://openacs.org/forums/message-view?message_id=158580" target="_top">Localization questions</a>.</p></li></ul></div></li><li><p><b>Replace the temporary message tags in ADP files. </b>From the same <tt class="computeroutput">Convert ADP ...</tt> page in <tt class="computeroutput">/acs-admin/apm</tt> as in the last step, repeat the process but deselect <tt class="computeroutput">Find human language text ...</tt> and select <tt class="computeroutput">Replace &lt;# ... #&gt; tags ...</tt> and click OK.  This step replaces all of the temporary tags with "short" message lookups, inserts the message keys into the database message catalog, and then writes that catalog out to an xml file.</p></li><li><p><b>Replace human-readable text in TCL files with temporary tags. </b>Examine all of the tcl files in the packages for human-readable text and replace it with temporary tags.  The temporary tags in TCL are slightly different from those in ADP.  If the first character in the temporary tag is an underscore (<tt class="computeroutput">_</tt>), then the message keys will be auto-generated from the original message text.  Here is an unmodified tcl file:</p><pre class="programlisting">
set title "Messages for $a(name) in $b(label)"
set context [list [list . "SimPlay"] \
                  [list [export_vars -base case-admin { case_id }] \ 
                    "Administer $a(name)"] \
                  "Messages for $a(name)"]
</pre><p>... and here is the same file after temporary message tags have been manually added:</p><pre class="programlisting">
set title &lt;#admin_title Messages for %a.name% in %b.label%#&gt;
set context [list [list . &lt;#_ SimPlay#&gt;] \
                  [list [export_vars -base case-admin { case_id }] \
                    &lt;#_ Administer %a.name%#&gt;] \
                  &lt;#_ Messages for %a.name%#&gt;]
</pre><p>Note that the message key <tt class="computeroutput">case_admin_page_title</tt> was manually selected, because an autogenerated key for this text, with its substitute variables, would have been very confusing
</p></li><li><p><b>Replace the temporary message tags in TCL files. </b>Repeat step 2 for tcl files.  Here is the example TCL file after conversion:</p><pre class="programlisting">
set title [_ simulation.admin_title]
set context [list [list . [_ simulation.SimPlay]] \
                  [list [export_vars -base case-admin { case_id }] \
                    [_ simulation.lt_Administer_name_gt]] \
                  [_ simulation.lt_Messages_for_role_pre]]
</pre></li><li><p><b>Internationalize SQL Code. </b>If there is any user-visible TCL code in the .sql or .xql files, internationalize that the same way as for the TCL files.</p></li><li><p><b>Internationalize Package Parameters. </b>
      See <a href="i18n-introduction.html#i18n-message-apm-params">Multilingual APM Parameters</a>
    </p></li><li><p><b>Internationalize Date and Time queries. </b></p><div class="orderedlist"><ol type="a"><li><p>Find datetime in .xql files.  Use command line tools to find suspect SQL code:</p><pre class="programlisting">grep -r "to_char.*H" *
grep -r "to_date.*H" *
</pre></li><li><p>In SQL statements, replace the format string with the ANSI standard format, <tt class="computeroutput">YYYY-MM-DD HH24:MI:SS</tt> and change the field name to *_ansi so that it cannot be confused with previous, improperly formatting fields.  For example,</p><pre class="programlisting">to_char(timestamp,'MM/DD/YYYY HH:MI:SS') as foo_date_pretty</pre><p>becomes</p><pre class="programlisting">to_char(timestamp,'YYYY-MM-DD HH24:MI:SS') as foo_date_ansi</pre></li><li><p>In TCL files where the date fields are used, convert the datetime from local server timezone, which is how it's stored in the database, to the user's timezone for display.  Do this with the localizing function <tt class="computeroutput"><a href="/api-doc/proc-view?proc=lc_time_system_to_conn" target="_top">lc_time_system_to_conn</a></tt>:</p><pre class="programlisting">
set foo_date_ansi [lc_time_system_to_conn $foo_date_ansi]</pre><p>When a datetime will be written to the database, first convert it from the user's local time to the server's timezone with <tt class="computeroutput"><a href="/api-doc/proc-view?proc=lc%5ftime%5fconn%5fto%5fsystem" target="_top">lc_time_conn_to_system</a></tt>.
</p></li><li><p>When a datetime field will be displayed, format it using the localizing function <tt class="computeroutput"><a href="/api-doc/proc-view?proc=lc_time_fmt" target="_top">lc_time_fmt</a></tt>. lc_time_fmt takes two parameters, datetime and format code.  Several format codes are usable for localization; they are placeholders that format dates with the appropriate codes for the user's locale.  These codes are: <tt class="computeroutput">%x, %X, %q, %Q, and %c.</tt></p><pre class="programlisting">set foo_date_pretty [lc_time_fmt $foo_date_ansi "%x %X"]</pre><p>
          Use the <tt class="computeroutput">_pretty</tt> version in your ADP page.
        </p><div class="itemizedlist"><ul type="disc"><li><p>
          %c: Long date and time (Mon November 18, 2002 12:00 AM)
        </p></li><li><p>
          %x: Short date (11/18/02)
        </p></li><li><p>
          %X: Time (12:00 AM)
        </p></li><li><p>
          %q: Long date without weekday (November 18, 2002)
        </p></li><li><p>
           %Q: Long date with weekday (Monday November 18, 2002)
        </p></li></ul></div><p>
      The "q" format strings are OpenACS additions; the rest follow unix standards (see <tt class="computeroutput">man
      strftime</tt>).
    </p></li></ol></div></li><li><p><b>Internationalize Numbers. </b>
            To internationalize numbers, use <tt class="computeroutput">lc_numeric $value</tt>, which formats the number using the appropriate decimal point and thousand separator for the locale.
          </p></li><li><p><b>Internationalizing Forms. </b>When coding forms, remember to use message keys for each piece of text that is user-visible, including form option labels and button labels.</p></li><li><p><a name="catalog-consistency-check"></a><b>Checking the Consistency of Catalog Files. </b>
        This section describes how to check that the set of keys used in
        message lookups in tcl, adp, and info files and the set of keys in
        the catalog file are identical.  The scripts below assume that
        message lookups in adp and info files are on the format
        \#package_key.message_key\#, and that message lookups in tcl files
        are always is done with one of the valid lookups described above. The script further assumes
        that you have perl installed and in your path.  Run the script like
        this:
      </p><tt class="computeroutput">
      acs-lang/bin/check-catalog.sh package_key
      </tt><p>
        where package_key is the key of the package that you want to
        test. If you don't provide the package_key argument then all
        packages with catalog files will be checked. 
        The script will run its checks primarily on en_US xml catalog files.
      </p></li></ol></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2555716"></a>Common mistakes while internationalizing</h3></div></div><div></div></div><div class="itemizedlist"><ul type="disc"><li><p><b>Don't internationalize internal code words. </b>Many packages use code words or key words, such as "open" and "closed", which will never be shown to the user.  They may match key values in the database, or be used in a switch or if statement.  Don't change these.</p></li><li><p>These notes haven't been formatted yet:</p><div class="literallayout"><p><br>
<br>
<br>
There are a nubmer of instances of constructing sentences via concatination (you <br>
can just look at keys like: <br>
  &lt;msg key="Page_with_pagination"&gt;Page with  [ %pagination_filter% ] &amp;nbsp; &amp;nbsp; Show&lt;/msg&gt;<br>
to spot them.<br>
<br>
They key choice is not great.  It's as if in coding you decided to use <br>
v1, v2, v3... for your variable names.<br>
<br>
Here is You_#:<br>
<br>
&lt;msg key="You"&gt;You can filter by this %component_name% by viisting %filter_url_string%&lt;/msg&gt;<br>
&lt;msg key="You_1"&gt;You do not have permission to map this patch to a bug. Only the submitter of the patch and users with write permission on this Bug Tracker project (package instance) may do so.&lt;/msg&gt;<br>
&lt;msg key="You_2"&gt;You do not have permission to edit this patch. Only the submitter of the patch and users with write permission on the Bug Tracker project (package instance) may do so.&lt;/msg&gt;<br>
&lt;msg key="You_3"&gt;You do not have permission to reopen this refused patch, only users with write permission on the Bug Tracker package instance (project) may do so.&lt;/msg&gt;<br>
&lt;msg key="You_4"&gt;You do not have permission to reopen this deleted patch, only users with write permission on the Bug Tracker package instance (project) and the submitter of the patch may do so.&lt;/msg&gt;<br>
&lt;msg key="You_5"&gt;do not have permission to cancel this patch - only the submitter of the patch may do so. If you are an administrator you can however refuse the patch.&lt;/msg&gt;<br>
&lt;msg key="You_6"&gt;You don't have permission to edit this patch.&lt;/msg&gt;<br>
&lt;msg key="You_7"&gt;You do not have permission to unmap a bug from this patch. Only the submitter of the patch and users with write permission on the Bug Tracker package instance (project) may do so.&lt;/msg&gt;<br>
<br>
I would much prefer keys like: filter_by_link, perm_nomap, perm_noedit, perm_noropen_refused, etc. <br>
<br>
Also, the semantic content is at odds with the key in a lot of them<br>
eg:<br>
<br>
 &lt;msg key="Fix"&gt;for version&lt;/msg&gt;<br>
 &lt;msg key="Fix_1"&gt;for&lt;/msg&gt;<br>
 &lt;msg key="Fix_2"&gt;for Bugs&lt;/msg&gt;<br>
<br>
<br>
The reason I think message key choice is important is that programmers and<br>
designers, when editing an tcl or adp page, can easily get things<br>
confused and put in the wrong key.  It can also act as a simple<br>
guide for translators for intended semantic content of a key.<br>
<br>
<br>
============================================================-<br>
<br>
SOME SPECIFIC COMMENTS PER FILE:<br>
<br>
http://cvs.openacs.org/cvs/openacs-4/packages/bug-tracker/lib/nav-bar.tcl?r1=1.12&amp;r2=1.11<br>
<br>
You assume:<br>
<br>
  multirow append links "New [bug_tracker::conn Bug]" "${url_prefix}bug-add"<br>
<br>
can be translated as <br>
<br>
  multirow append links "[_ bug-tracker.New] [bug_tracker::conn Bug]" "${url_prefix}bug-add"<br>
<br>
You should translate this as something like<br>
<br>
  set bug_label [bug_tracker::conn Bug]<br>
  multirow append links "[_ bug-tracker.New_Bug]" "${url_prefix}bug-add"<br>
<br>
where New_Bug is "New %bug_label%"<br>
<br>
(same problem with New Patch).<br>
<br>
============================================================<br>
<br>
http://cvs.openacs.org/cvs/openacs-4/packages/bug-tracker/lib/pagination.adp?r1=1.4&amp;r2=1.3<br>
<br>
<br>
Again, bad to translate fragments:<br>
<br>
  Page with  [ @pagination_filter@ ]     Show &lt;input type="text" name="interval_size" value="@interval_size@" /&gt; @pretty_plural@ per page &lt;input type="submit" value="Go" /&gt; 	 <br>
<br>
 translated to <br>
<br>
  #bug-tracker.Page_with_pagination# &lt;input type="text" name="interval_size" value="@interval_size@" /&gt; #bug-tracker.pretty_plural_per_page# &lt;input type="submit" value="Go" /&gt;<br>
<br>
 with key <br>
<br>
  &lt;msg key="Page_with_pagination"&gt;Page with  [ %pagination_filter% ] &amp;nbsp; &amp;nbsp; Show&lt;/msg&gt;<br>
<br>
<br>
<br>
============================================================<br>
<br>
http://cvs.openacs.org/cvs/openacs-4/packages/bug-tracker/tcl/bug-procs.tcl?r1=1.15&amp;r2=1.14<br>
<br>
<br>
You tranlate an internal key here: <br>
<br>
  workflow::case::add_log_data \ 	    <br>
       -entry_id $entry_id \ 	    <br>
       -key "resolution" \ 	    <br>
       -value [db_string select_resolution_code {}]<br>
<br>
  workflow::case::add_log_data \ 	    <br>
       -entry_id $entry_id \<br>
       -key "[_ bug-tracker.resolution]" \<br>
       -value [db_string select_resolution_code {}]<br>
<br>
(see also bug 1748)<br>
<br>
----------------------------------------<br>
<br>
I think the key choice here is poor.  You should attempt to preserve semantic meaning<br>
of these phrases in the key:<br>
<br>
 return "Bug-tracker component maintainer" translated to return "[_ bug-tracker.Bug-tracker]"<br>
<br>
 return "Bug-tracker bug info" translated to return "[_ bug-tracker.Bug-tracker_2]"<br>
<br>
 return "Bug-tracker project maintainer" translated to return "[_ bug-tracker.Bug-tracker_1]"<br>
<br>
<br>
============================================================<br>
<br>
http://cvs.openacs.org/cvs/openacs-4/packages/bug-tracker/www/admin/component-ae.tcl?r1=1.10&amp;r2=1.9<br>
<br>
bad key choice and I am not sure why the Add and Edit words are removed for this: <br>
<br>
 if { [info exists component_id] } {<br>
     set page_title "Edit [bug_tracker::conn Component]"<br>
 } else {<br>
     set page_title "Add [bug_tracker::conn Component]"<br>
 }<br>
<br>
 translated to:<br>
<br>
 if { [info exists component_id] } {<br>
     set page_title [_ bug-tracker.Edit_1]<br>
 } else {<br>
     set page_title [_ bug-tracker.Add]<br>
 }<br>
<br>
<br>
 Edit_1 and Add are:<br>
<br>
 &lt;msg key="Edit_1"&gt;%component_name%&lt;/msg&gt;<br>
 &lt;msg key="Add"&gt;%component_name%&lt;/msg&gt;<br>
<br>
----------------------------------------<br>
<br>
Where did Name go in label:<br>
<br>
    {name:text {html { size 50 }} {label "[bug_tracker::conn Component] Name"}}<br>
  translated to <br>
    {name:text {html { size 50 }} {label "[_ bug-tracker.Component]"}}<br>
  with <br>
    &lt;msg key="Component"&gt;Component&lt;/msg&gt; <br>
<br>
<br>
----------------------------------------<br>
<br>
Bad key choice:<br>
<br>
   {help_text "You can filter by this [bug_tracker::conn component] by viisting [ad_conn package_url]com/this-name/"}<br>
 tranlated to <br>
   {help_text "[_ bug-tracker.You]"}<br>
<br>
<br>
============================================================<br>
<br>
http://cvs.openacs.org/cvs/openacs-4/packages/bug-tracker/www/admin/index.adp?r1=1.7&amp;r2=1.6<br>
<br>
<br>
Convoluted logic in adp, concatenating bug/bugs with a number:<br>
<br>
&lt;if @components.view_bugs_url@ not nil&gt;&lt;a href="@components.view_bugs_url@" title="View the @pretty_names.bugs@ for this component"&gt;&lt;/if&gt;@components.num_bugs@ &lt;if @components.num_bugs@ eq 1&gt;@pretty_names.bug@&lt;/if&gt;&lt;else&gt;@pretty_names.bugs@&lt;/else&gt;&lt;if @components.view_bugs_url@ not nil&gt;&lt;/a&gt;&lt;/if&gt;<br>
<br>
&lt;if @components.view_bugs_url@ not nil&gt;&lt;a href="@components.view_bugs_url@" title="#bug-tracker.View_the_bug_fo_component#"&gt;&lt;/if&gt;@components.num_bugs@ &lt;if @components.num_bugs@ eq 1&gt;@pretty_names.bug@&lt;/if&gt;&lt;else&gt;@pretty_names.bugs@&lt;/else&gt;&lt;if @components.view_bugs_url@ not nil&gt;&lt;/a&gt;&lt;/if&gt;<br>
<br>
It would probably be better to do this as something like:<br>
<br>
&lt;if @components.view_bugs_url@ not nil&gt;<br>
  &lt;if @components.num_bugs@ eq 1&gt;<br>
    &lt;a href="@components.view_bugs_url@" title="#bug-tracker.View_the_bug_fo_component#"&gt;#bug-tracker.one_bug#&lt;/a&gt;<br>
  &lt;/if&gt;&lt;else&gt;<br>
    &lt;a href="@components.view_bugs_url@" title="#bug-tracker.View_the_bug_fo_component#"&gt;#bug-tracker.N_bugs#&lt;/a&gt;<br>
  &lt;/else&gt;<br>
&lt;/if&gt;<br>
<br>
============================================================<br>
<br>
http://cvs.openacs.org/cvs/openacs-4/packages/bug-tracker/www/admin/versions.adp?r1=1.6&amp;r2=1.5<br>
<br>
Full name created by concatenating first and last name (admittedly this is pervasive in the toolkit):<br>
<br>
  &lt;a href="@past_version.maintainer_url@" title="#bug-tracker.Email# @past_version.maintainer_email@"&gt;@past_version.maintainer_first_names@ @past_version.maintainer_last_name@&lt;/a&gt;<br>
<br>
Also, title is concatenated as well.<br>
<br>
============================================================<br>
<br>
http://cvs.openacs.org/cvs/openacs-4/packages/bug-tracker/www/bug.tcl?r1=1.28&amp;r2=1.27<br>
<br>
Internal key translated:<br>
 {show_patch_status "open"}<br>
to <br>
 {show_patch_status "[_ bug-tracker.open]"}<br>
<br>
<br>
Does this work?<br>
         set page_title "[bug_tracker::conn Bug] #$bug_number"<br>
tranlated to:<br>
	 set Bug_name [bug_tracker::conn Bug]<br>
 	 set page_title "[_ bug-tracker.%Bug_name% %bug_number%]"<br>
<br>
I don't see how bug-tracker.%Bug_name% can be expected to exist but maybe I don't <br>
understand the idiom.<br>
<br>
Internal key translated: <br>
<br>
  if { [string equal [workflow::action::get_element -action_id $action_id -element short_name] "edit"] } {<br>
<br>
to <br>
<br>
  if { [string equal [workflow::action::get_element -action_id $action_id -element short_name] "[_ acs-kernel.common_edit]"] } {<br>
<br>
<br>
============================================================<br>
<br>
http://cvs.openacs.org/cvs/openacs-4/packages/bug-tracker/www/patch.tcl?r1=1.9&amp;r2=1.8<br>
<br>
All the mode internal keys were translated.<br>
<br>
----------------------------------------<br>
I would suggest that the option list be returned from a function so this is not duplicated all over the place:<br>
<br>
 -options { { "[_ bug-tracker.Plain]" plain } { "[_ bug-tracker.HTML]" html } { "[_ bug-tracker.Preformatted]" pre } }<br>
<br>
These also seem like a candidate for common keys.<br>
<br>
----------------------------------------<br>
<br>
mode, status internal keys translated here as well.<br>
<br>
<br>
<br>
I fixed most of the outright bugs in the bug-tracker.<br>
<br>
The other things I ran into were:<br>
<br>
1. Quoting in the message catalog for tcl <br>
<br>
   i.e. a string like <br>
     set title "Patch \"$patch_summary\" is nice."<br>
   being translated to <br>
     &lt;msg&gt;Patch \"$patch_summary\" is nice.&lt;/msg&gt;<br>
   (should remove the \ quoting since its not needed).<br>
<br>
   Also, some keys had %var;noquote%, which is not needed since those<br>
   variables are not quoted (and in fact the variable won't even be<br>
   recognized so you get the literal %var;noquote% in the output).<br>
<br>
<br>
2. Things in literal lists like<br>
<br>
     array set names { key "Pretty" ...} <br>
<br>
   being translated to <br>
<br>
     array set names { key "[_bug-tracker.Pretty]" ...} <br>
<br>
  which won't work since the _ func will not be called <br>
  <br>
  Needs to be     <br>
     <br>
     array set names [list key [_bug-tracker.Pretty] ...]<br>
<br>
  (strictly speaking the " does not need to go but "[...]" <br>
  pretty much never needs quotes and I mostly find them annoying).<br>
<br>
<br>
3. A lot of the acs-kernel.common_* keys had the wrong case (although <br>
   we have keys like acs-kernel.common_edit = "Edit" which I think is <br>
   a mistake).<br>
<br>
<br>
<br>
The big remaining issue is that we have things like <br>
bug_tracker::bug::workflow_create with lookups in the spec but<br>
I don't think you want to do those lookups til runtime.<br>
<br>
Also the parameters in bug_tracker::get_default_configurations<br>
should be translated  (I am not sure if this gets stuffed into the db<br>
or not).<br>
<br>
</p></div></li><li><p>Code within curly brackets isn't evaluated.  This code</p><pre class="programlisting">return { key "[_ bug-tracker.Key_Desc]" }</pre><p>... will not process correctly.  Instead, it should be</p><pre class="programlisting">return {??? }</pre></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="i18n-introduction.html">Prev</a> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right"> <a accesskey="n" href="i18n-design.html">Next</a></td></tr><tr><td width="40%" align="left">How Internationalization/Localization works in OpenACS </td><td width="20%" align="center"><a accesskey="u" href="i18n.html">Up</a></td><td width="40%" align="right"> Design Notes</td></tr></table><hr><address><a href="mailto:docs@openacs.org">docs@openacs.org</a></address></div><a name="comments"></a><center><a href="http://openacs.org/doc/i18n-convert.html#comments">View comments on this page at openacs.org</a></center></body></html>
