<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type"><title>Creating a Package</title><meta name="generator" content="DocBook XSL Stylesheets V1.50.0"><link rel="home" href="index.html" title="OpenACS Documentation"><link rel="up" href="tutorial.html" title="Chapter 8. Development Tutorial"><link rel="previous" href="tutorial.html" title="Chapter 8. Development Tutorial"><link rel="next" href="tutorial-database.html" title="Setting Up Database Objects"><link rel="stylesheet" href="openacs.css" type="text/css"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><a href="http://openacs.org"><img src="images/alex.jpg" border="0"></a><table width="100%" summary="Navigation header" border="0"><tr><td width="20%" align="left"><a accesskey="p" href="tutorial.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter 8. Development Tutorial</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="tutorial-database.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="tutorial-newpackage"></a>Creating a Package</h2></div></div><div class="authorblurb"><p>
      by <a href="mailto:joel@aufrecht.org" target="_top">Joel Aufrecht</a><br>
          OpenACS docs are written by the named authors, but may be edited
          by OpenACS documentation staff.
        </p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="id2852974"></a>Overview</h3></div></div><p>To start developing new code in OpenACS, we build a new
    package.  A package is a a discrete collection of web
    pages, tcl code, and database tables and procedures.  A package
    can be installed, upgraded, and removed.  It communicates with
    other packages through an API.  This chapter walks you through the
    minimum steps to create a useful package, including:</p><div class="itemizedlist"><ul type="disc"><li><p>How to use the APM to start a new package</p></li><li><p>How to write documentation, including self-documenting code</p></li><li><p>How to set up the database tables and procedures.</p></li><li><p>How to write web pages.</p></li><li><p>How to add automated regression testing to your packages</p></li><li><p>How to debug your package</p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="id2853036"></a>Before you begin</h3></div></div><p>You will need:</p><div class="itemizedlist"><ul type="disc"><li><p>A computer with a working installation of OpenACS
	    4.6.  If you don't have this, see <a href="install-overview.html">Installation Overview</a>.
	  </p></li><li><p>Example files, which are included in the
standard OpenACS 4.6.2 distribution.
	  </p></li></ul></div><div class="figure"><p class="title"><b>Figure 8.1. Assumptions in this section</b></p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td>Fully qualified domain name of your server</td><td><span class="replaceable">yourserver.test</span></td></tr><tr><td>URL of your server</td><td><span class="replaceable">http://yourserver.test:8000</span></td></tr><tr><td>Name of development account</td><td><span class="replaceable">service0</span></td></tr><tr><td>New Package key</td><td><span class="replaceable">samplenote</span></td></tr></tbody></table></div></div></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="id2853162"></a>Use the APM to start a new package</h3></div></div><p>Tee ACS Package Manager initializes new packages.  This sets
    up the initial directories, meta-information files, and
    database entries for a new package.
</p><div class="orderedlist"><ol type="1"><li><p>Browse to <tt>http://<span class="replaceable">yourserver</span>:8000/acs-admin/apm</tt>.
</p></li><li><p>Click <tt>Create a New Package</tt>.</p><p>Fill in the fields listed below.  Tab through the rest.
        (Some will change automatically.  Don't mess with those.)
</p><div class="itemizedlist"><ul type="disc"><li><p>
              <tt>Package Key</tt>:
              <b><tt>samplenote</tt></b></p></li><li><p>
              <tt>Package Name</tt>:
              <b><tt>Notes (Sample Application)</tt></b>
            </p></li><li><p>
              <tt>Package Plural</tt>:
              <b><tt>Notes (Sample Applications)</tt></b></p></li><li><p>	  
              <tt>Initial Version</tt>:
              <b><tt>0.1d</tt></b>
            </p></li><li><p><tt>Summary</tt>:
              <b><tt>This is my first package.</tt></b>
            </p></li></ul></div><p>At the bottom, <span class="bold"><b>click
        <tt><span class="guibutton">Create Package</span></tt></b></span>.
        </p></li></ol></div></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="id2853350"></a>Mount the package in the site map</h3></div></div><p>In order to see your work in progress, you must create a
      map between the URL space of incoming requests and the package.
      You do this by mounting the package in the Site Map.</p><div class="orderedlist"><ol type="1"><li><p>Browse to
<tt>http://yourserver:8000/admin/site-map/</tt>.</p></li><li><p>Click the <tt><span class="guilabel">new sub
        folder</span></tt> link on the Main Site
        line. </p></li><li><p>Type <b><tt>samplenote</tt></b>
and click <tt><span class="guibutton">New</span></tt>. </p></li><li><p>Click the <tt><span class="guilabel">new
application</span></tt> link on the <tt><span class="guilabel">samplenote</span></tt> line. </p></li><li><p>Type <b><tt>Sample Note</tt></b>
where it says
<tt><span class="guilabel">untitled</span></tt>, choose
<tt><span class="guilabel">Notes (Sample Application)</span></tt> from the
drop-down list, and click
<tt><span class="guibutton">New</span></tt>.
</p></li></ol></div><p>By mounting the package, we've caused all requests to
      <tt>http://yourserver.test/samplenote</tt>
      to be satisfied from the files at <tt>/web/service0/packages/samplenote/www</tt>.</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="id2853528"></a>Write the Requirements and Design Specs</h3></div></div><p>It's time to document.  For a new package you should
	start by copying the documentation template from
	<tt>/web/openacs-dev/packages/acs-core-docs/xml/docs/xml/package-documentation-template.xml</tt>
	to
	<tt>yourpackage/www/docs/xml/package-documentation.xml</tt>.</p><p>You then open that file with emacs, write the
	requirements and design section, generate html, and start
	coding.  For this tutorial, you should instead install the
	pre-written documentation files for the tutorial app, examine
	them, generate html, read it, and then proceed to build the
	package.  Store any diagrams in native format in the
	<tt>www/doc/xml</tt> directory, and
	store png or jpg versions of the diagrams in the
	<tt>www/doc</tt> direcory.</p><p>Pre-written documentation is available for this
      tutorial, so we'll copy that documentation and edit it.  Log in
      as <span class="replaceable">service0</span>, create the standard
      directories, and copy the prepared documentation:</p><pre class="screen">[service0@anthrax service0]$ <b><tt>cd /web/service0/packages/samplenote/</tt></b>
[service0@anthrax samplenote]$ <b><tt>mkdir -p www/doc/xml</tt></b>
[service0@anthrax samplenote]$ <b><tt>cp /web/service0/packages/acs-core-docs/www/files/samplenote/* www/doc/xml/</tt></b>
[service0@anthrax samplenote]$ <b><tt>mv www/doc/xml/*.dia www/doc/</tt></b>
[service0@anthrax samplenote]$ <b><tt>mv www/doc/xml/*.png www/doc/</tt></b>
[service0@anthrax samplenote]$</pre><p> OpenACS uses DocBook for documentation.  DocBook is
	an XML standard for semantic markup of documentation.  That
	means that the tags you use indicate meaning, not intended
	appearance.  The style sheet will determine appearance.</p><p>Open the file <tt>index.xml</tt>
      in emacs.  Examine the file.  Find the version history (look for the tag
        <tt>&lt;revhistory&gt;</tt>).  Add a
        new record to the document version history.  Look for the
        <tt>&lt;authorgroup&gt;</tt> tag and
        add yourself as a second author.  Save and exit.  For tips on
        editing SGML files in emacs, see <a href="docbook-primer.html">OpenACS Documentation Guide</a></p><p>Process the xml file to create html documentation.  The
      html documentation, including supporting files such as pictures,
      is stored in the <tt>www/docs/</tt>
      directory.  A Makefile is provided to generate html from the xml, and copy all of the
      supporting files.  If Docbook is set up correctly, all you need
      to do is:</p><pre class="screen">[service0@anthrax samplenote]$ <b><tt>cd www/doc/xml</tt></b>
[service0@anthrax xml]$<b><tt> make</tt></b>
cd .. ; /usr/bin/xsltproc ../../../acs-core-docs/www/xml/openacs.xsl xml/index.xml
Writing requirements-introduction.html for sect1(requirements-introduction)
Writing requirements-overview.html for sect1(requirements-overview)
Writing requirements-cases.html for sect1(requirements-cases)
Writing sample-data.html for sect1(sample-data)
Writing sample-data.html for sect1(sample-data)
Writing requirements.html for chapter(requirements)
Writing design-data-model.html for sect1(design-data-model)
Writing design-ui.html for sect1(design-ui)
Writing design-config.html for sect1(design-config)
Writing design-future.html for sect1(design-future)
Writing filename.html for chapter(filename)
Writing user-guide.html for chapter(user-guide)
Writing admin-guide.html for chapter(admin-guide)
Writing bi01.html for bibliography
Writing index.html for book
[service0@yourserver xml]$</pre><p>Verify that the documentation was generated and reflects
      your changes in the xml by browsing to <tt>http://<span class="replaceable">yoursite</span>:8000/samplenote/doc</tt></p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="id2853760"></a>Add the new package to CVS</h3></div></div><p>Before you do any more work, make sure that your work is
      protected by putting it all into cvs.  The <tt>cvs
      add</tt> command is not recursive, so you'll have to
      traverse the directory tree manually and add as you go.</p><pre class="screen">[service0@yourserver xml]$ <b><tt>cd ..</tt></b>
[service0@yourserver doc]$ <b><tt>cd ..</tt></b>
[service0@yourserver www]$ <b><tt>cd ..</tt></b>
[service0@yourserver samplenote]$ <b><tt>cd ..</tt></b>
[service0@yourserver packages]$ <b><tt>cvs add samplenote/</tt></b>
Directory /cvsroot/service0/packages/samplenote added to the repository
[service0@yourserver packages]$ <b><tt>cd samplenote/</tt></b>
[service0@yourserver samplenote]$ <b><tt>cvs add www</tt></b>
Directory /cvsroot/service0/packages/samplenote/www added to the repository
[service0@yourserver samplenote]$ <b><tt>cd www</tt></b>
[service0@yourserver www]$ <b><tt>cvs add doc</tt></b>
Directory /cvsroot/service0/packages/samplenote/www/doc added to the repository
[service0@yourserver www]$ <b><tt>cd doc</tt></b>
[service0@yourserver doc]$ <b><tt>cvs add *</tt></b>
cvs add: cannot add special file `CVS'; skipping
cvs add: scheduling file `admin-guide.html' for addition
cvs add: scheduling file `bi01.html' for addition
cvs add: scheduling file `data-model.dia' for addition
cvs add: scheduling file `data-model.png' for addition
cvs add: scheduling file `design-config.html' for addition
cvs add: scheduling file `design-data-model.html' for addition
cvs add: scheduling file `design-future.html' for addition
cvs add: scheduling file `design-ui.html' for addition
cvs add: scheduling file `filename.html' for addition
cvs add: scheduling file `index.html' for addition
cvs add: scheduling file `page-map.dia' for addition
cvs add: scheduling file `page-map.png' for addition
cvs add: scheduling file `requirements-cases.html' for addition
cvs add: scheduling file `requirements-introduction.html' for addition
cvs add: scheduling file `requirements-overview.html' for addition
cvs add: scheduling file `requirements.html' for addition
cvs add: scheduling file `sample-data.html' for addition
cvs add: scheduling file `sample.png' for addition
cvs add: scheduling file `user-guide.html' for addition
cvs add: scheduling file `user-interface.dia' for addition
cvs add: scheduling file `user-interface.png' for addition
Directory /cvsroot/service0/packages/samplenote/www/doc/xml added to the repository
cvs add: use 'cvs commit' to add these files permanently
[service0@yourserver doc]$ <b><tt>cd xml</tt></b>
[service0@yourserver xml]$ <b><tt>cvs add Makefile index.xml</tt></b>
cvs add: scheduling file `Makefile' for addition
cvs add: scheduling file `index.xml' for addition
cvs add: use 'cvs commit' to add these files permanently
[service0@yourserver xml]$<b><tt> cd ../../..</tt></b>
[service0@yourserver samplenote]$ <b><tt>cvs commit -m &quot;new package&quot;</tt></b>
cvs commit: Examining .
cvs commit: Examining www
cvs commit: Examining www/doc
cvs commit: Examining www/doc/xml
RCS file: /cvsroot/service0/packages/samplenote/www/doc/admin-guide.html,v
done
Checking in www/doc/admin-guide.html;
/cvsroot/service0/packages/samplenote/www/doc/admin-guide.html,v  &lt;--  admin-guide.html
initial revision: 1.1
done
<span class="emphasis"><em>(many lines omitted)</em></span>
[service0@yourserver samplenote]$</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tutorial.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="tutorial-database.html">Next</a></td></tr><tr><td width="40%" align="left">Chapter 8. Development Tutorial&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="tutorial.html">Up</a></td><td width="40%" align="right">&nbsp;Setting Up Database Objects</td></tr></table><hr><address>rmello at fslc.usu.edu</address><address><a href="mailto:vinod@kurup.com">vinod@kurup.com</a></address></div><a name="comments"></a><center><a href="http://openacs.org/doc/openacs-4/tutorial-newpackage.html#comments">View comments on this page at openacs.org</a></center></body></html>
