<html xmlns:lxslt="http://xml.apache.org/xslt" xmlns:saxon="http://icl.com/saxon" xmlns:xalanredirect="org.apache.xalan.xslt.extensions.Redirect"><head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>6. Installing AOlserver 3.1</title><link rel="stylesheet" href="ad.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.24"><link rel="home" href="index.html" title="ACS Core"><link rel="up" href="unix-install.html" title="2. Installing on Unix/Linux"><link rel="previous" href="oracle.html" title="5. Installing Oracle 8.1.6"><link rel="next" href="acs.html" title="7. Installing the ArsDigita Community System v 4.0"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><a href="http://www.openacs.org/"><img src="images/alex.jpg" border="0" ></a><br><br><a class="topnav" href="/">Home</a><span class="topnav"> : </span><a class="topnav" href="index">Documentation</a><span class="topnav"> : </span><a class="topnav" href="acs-admin.html">Part II. For ACS Admins</a><span class="topnav"> : </span><a class="topnav" href="unix-install.html">2. Installing on Unix/Linux</a><span class="topnav"> : </span><strong class="topnav">6. Installing AOlserver 3.1&nbsp;</strong><hr size="1" noshade><div id="aolserver" class="sect1"><div class="titlepage"><h2 class="title" style="clear: all"><a name="aolserver"></a><span class="label">6.</span> <span class="title">Installing AOlserver 3.1</span></h2></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt>6.1. <a href="aolserver.html#install-aolserver-user-accounts">Setup User Accounts and Paths.</a></dt><dt>6.2. <a href="aolserver.html#install-aolserver-download">Download the Distribution</a></dt><dt>6.3. <a href="aolserver.html#install-aolserver-compile">Compile AOLserver</a></dt><dt>6.4. <a href="aolserver.html#install-aolserver-compile-oradriver">Compile the Oracle Driver</a></dt><dt>6.5. <a href="aolserver.html#install-aolserver-installaol">Install AOLserver 3.1</a></dt><dt>6.6. <a href="aolserver.html#install-aolserver-troubleshooting">Troubleshooting the AOLserver Install</a></dt><dt>6.7. <a href="aolserver.html#install-aolserver-defaults">Defaults</a></dt></dl></div><div id="install-aolserver-user-accounts" class="sect2"><div class="titlepage"><h3 class="title"><a name="install-aolserver-user-accounts"></a><span class="label">6.1.</span> <span class="title">Setup User Accounts and Paths.</span></h3></div><p>You will need a special user account for running the ACS. We recommend
    that you call this user <strong>nsadmin</strong>. This user will have a
    special home directory for storing AOLserver,
    <strong>/home/aol31</strong> and a special group for the server files,
    <strong>web</strong> as well. You will also need to create directories
    for AOLserver, <strong>/usr/local/aolserver</strong>, and for web
    services, <strong>/web</strong> to reside in. You must execute this step
    as root.</p><div class="itemizedlist"><ul><li><a name="N2567"></a><p>
        Open up a terminal and run these commands: </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ su -
; Enter ROOT password when prompted
# groupadd nsadmin
# groupadd web
# mkdir /home/aol31
# useradd -g nsadmin -G dba,web -d /home/aol31 nsadmin
# passwd nsadmin
; Set password for nsadmin
       
# mkdir /web
# mkdir /usr/local/aolserver
# chown nsadmin.web /home/aol31 
# chown nsadmin.web /web
# chown nsadmin.web /usr/local/aolserver
# chmod 775 /home/aol31
# chmod 775 /web
# chmod 775 /usr/local/aolserver

# exit   
   
</pre></td></tr></table></blockquote></li><li><a name="N2573"></a><p>
        At this point, you should customize the <strong>nsadmin</strong>
        login scripts. Login as <strong>nsadmin</strong> and add the
        following lines to your <strong>~nsadmin/.bash_profile</strong> </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
export ORACLE_BASE=/ora8/m01/app/oracle
export ORACLE_HOME=$ORACLE_BASE/product/8.1.6
export PATH=$PATH:$ORACLE_HOME/bin
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib
export ORACLE_SID=ora8
export ORACLE_TERM=vt100
export ORA_NLS33=$ORACLE_HOME/ocommon/nls/admin/data
   
</pre></td></tr></table></blockquote><p>Be absolutely certain that you have entered these lines correctly
        and that you have saved the file - a slight error in these lines can
        lead to many inscrutable error messages. Logout and log back in so
        these settings will take effect.</p></li></ul></div></div><div id="install-aolserver-download" class="sect2"><div class="titlepage"><h3 class="title"><a name="install-aolserver-download"></a><span class="label">6.2.</span> <span class="title">Download the Distribution</span></h3></div><p>Login as <strong>nsadmin</strong> and save files to the
    <strong>/tmp</strong> directory.</p><div class="itemizedlist"><ul><li><a name="N2603"></a><p>
        Download the AOLserver distribution and the Oracle driver (needed for
        db connectivity and the ACS). You must download the <i>source</i>
        distribution of AOLserver in order to compile the Oracle driver. </p><div class="itemizedlist"><ul><li><a name="N2610"></a><p><a href="http://www.openacs.org/download/" target="_top">AOLserver 3.1
          Source Distribution</a></p><p>
          <i>Do not download a binary!</i></p></li><li><a name="N2619"></a><p><a href="http://www.openacs.org/download/" target="_top">Oracle Driver
          2.x</a></p></li></ul></div><p>We recommend saving these archives in the <strong>/tmp</strong>
        directory on your server.</p></li><li><a name="N2629"></a><p>
        Uncompress the downloaded components; you may need to substitute
        different files names and account for directory names different from
        the ones below -- these were the files as of 9/2000 : </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ cd /tmp    <i>{or wherever the archives are}</i>
$ tar -xzf aolserver-src-3.1ad8.tar.gz
$ tar -xzf oracle-driver-2.3.tar.gz
 
</pre></td></tr></table></blockquote></li><li><a name="N2638"></a><p>
        You should now have two directory trees in the current directory:
        <strong>aolserver/</strong> and <strong>oracle-driver-2.3/</strong>.
        Move the oracle directory under the aolserver directory to make
        compiling the Oracle driver easier: </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ mv oracle-driver-2.3 aolserver
  
</pre></td></tr></table></blockquote></li></ul></div></div><div id="install-aolserver-compile" class="sect2"><div class="titlepage"><h3 class="title"><a name="install-aolserver-compile"></a><span class="label">6.3.</span> <span class="title">Compile AOLserver</span></h3></div><p>This step should be completed as the nsadmin user. You will compile
    the AOLserver distribution and prepare for installation.</p><div class="itemizedlist"><ul><li><a name="N2657"></a><p>
        Login as <strong>nsadmin</strong> and cd into the aolserver/
        directory where you untarred the source. You should be able to
        compile directly from that location: 
<blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ su - nsadmin
; Enter nsadmin password
$ cd /tmp/aolserver
$ make all
   
</pre></td></tr></table></blockquote>
      </p></li></ul></div></div><div id="install-aolserver-compile-oradriver" class="sect2"><div class="titlepage"><h3 class="title"><a name="install-aolserver-compile-oradriver"></a><span class="label">6.4.</span> <span class="title">Compile the Oracle Driver</span></h3></div><p>Now you need to compile the Oracle driver to enable database
    connectivity.</p><div class="itemizedlist"><ul><li><a name="N2674"></a><p>
        Change directories to the
        <strong>aolserver/oracle-driver-2.3</strong> directory and start the
        compilation:</p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ cd /tmp/aolserver/oracle-driver-2.3
$ make all
   
</pre></td></tr></table></blockquote><p>The following compiler warning may be ignored:</p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
ld: warning: type and size of dynamic symbol `sskgslgf' are not defined
</pre></td></tr></table></blockquote><p>If the compilation failed, make sure the environment variables
        above actually point to where you installed the AOLserver source
        code. If you followed our instructions, this should not be a problem.
        You can check the directories by doing:</p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ ls /tmp/aolserver/include
   
</pre></td></tr></table></blockquote><p>If you don't see any files, then you have the wrong
        directories. Verify your installation of Oracle and AOLserver and try
        again.</p><p>If compilation was successful, you should now have two new files
        in /tmp/aolserver/oracle-driver-2.3, <strong>ora8.so</strong> and
        <strong>ora8cass.so</strong>.</p></li></ul></div></div><div id="install-aolserver-installaol" class="sect2"><div class="titlepage"><h3 class="title"><a name="install-aolserver-installaol"></a><span class="label">6.5.</span> <span class="title">Install AOLserver 3.1</span></h3></div><p>You are now ready to install AOLserver.</p><div class="itemizedlist"><ul><li><a name="N2710"></a><p>
        Change directories to your AOLserver source distribution and run
        <strong>make install</strong> to install the files: </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
 
$ cd /tmp/aolserver
$ make install
    
</pre></td></tr></table></blockquote><p>
        The above will copy the compiled AOLserver files to
        <strong>/usr/local/aolserver</strong> 
</p></li><li><a name="N2724"></a><p>
        You should now have a <strong>/usr/local/aolserver/bin</strong>
        directory. Copy the previously compiled Oracle drivers into it: </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ cp /tmp/aolserver/oracle-driver-2.3/ora8.so /usr/local/aolserver/bin
$ cp /tmp/aolserver/oracle-driver-2.3/ora8cass.so /usr/local/aolserver/bin
     
</pre></td></tr></table></blockquote></li><li><a name="N2733"></a><p>
        The latest version of the ArsDigita Community System requires Tcl
        8.3. Although this version of Tcl is included with AOLserver 3.1, it
        is not activated by default. There is a symbolic link pointing from
        <tt>nsd</tt> to <tt>nsd76</tt> in
        <tt>/tmp/aolserver/bin</tt>. Change this to point to
        <tt>nsd8x</tt>: </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ cd /usr/local/aolserver/bin
$ rm nsd
$ ln -s ./nsd8x ./nsd
     
</pre></td></tr></table></blockquote></li><li><a name="N2755"></a><p>
        You will now test to ensure AOLserver is running correctly. You
        should be able to cd into your aolserver directory and simply start
        the server: </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
Login as nsadmin. (it helps to be in X at this point)
$ cd /usr/local/aolserver
$ ./bin/nsd -t nsd.tcl
     
</pre></td></tr></table></blockquote><p>As the AOLserver daemon starts up, you should see a few normal
        warnings (listed below), which are safe to ignore. The first warning
        means that the server is missing files for running
        <strong>ssl</strong>, a necessary module for encrypted HTTPS. The
        second warning means that the AOLserver control panel, a special
        module for administering AOLserver, could not be loaded. If
        you're interested in configuring and using either of these
        modules, please see the <a href="http://www.aolserver.com/" target="_top">AOLserver
        documentation</a>.</p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
Warning: nsd.tcl: nsssl not loaded -- key/cert files do not exist.
Warning: nsd.tcl: nscp not loaded -- user/password is not set. 
     
</pre></td></tr></table></blockquote></li><li><a name="N2773"></a><p>
        Test to see if AOLserver is working by starting <tt>Netscape</tt>
        or <tt>Lynx</tt>, and surfing over to your web page: </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ lynx localhost:8000
     
</pre></td></tr></table></blockquote><p>You should see a <strong>Welcome to AOLserver</strong> page. If
        this doesn't work, try going to
        <strong>http://127.0.0.1:8000/</strong>.
      </p></li><li><a name="N2795"></a><p>
        Shutdown the test server: </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
$ killall nsd
     
</pre></td></tr></table></blockquote><p>The <tt>killall</tt> command will kill all processes with the
        name <tt>nsd</tt>, but clearly this is not a good tool to use for
        managing your services in general. We cover this topic in the <a href="acs.html#startup" target="_top">ACS documentation</a>.</p></li></ul></div><p>On to installing the <a href="acs.html" target="_top">ArsDigita Community
    System</a>!</p></div><div id="install-aolserver-troubleshooting" class="sect2"><div class="titlepage"><h3 class="title"><a name="install-aolserver-troubleshooting"></a><span class="label">6.6.</span> <span class="title">Troubleshooting the AOLserver Install</span></h3></div><p>If you can't view the welcome page, it's likely there's a
    problem with your server configuration. Start by viewing your AOLserver
    log, which is in <strong>/usr/local/aolserver/log/server.log</strong>.
    You should also try to find lines of the form:</p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
[01/Jun/2000:12:11:20][5914.2051][-nssock-] Notice: nssock: listening on http://localhost.localdomain:8000 (127.0.0.1:8000)
[01/Jun/2000:12:11:20][5914.2051][-nssock-] Notice: accepting connections
</pre></td></tr></table></blockquote><p>If you can find these lines, try entering the URL the server is
    listening on. If you cannot find these lines, there must be an error
    somewhere in the file. Search for lines beginning with the word
    <strong>Error</strong> instead of <strong>Notice</strong>.</p></div><div id="install-aolserver-defaults" class="sect2"><div class="titlepage"><h3 class="title"><a name="install-aolserver-defaults"></a><span class="label">6.7.</span> <span class="title">Defaults</span></h3></div><p>We used the following defaults while installing AOLserver:</p><div class="informaltable" id="N2847"><a name="N2847"></a><table cellpadding="5" cellspacing="0" border="1"><colgroup><col><col><col></colgroup><tbody><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional"><strong xmlns="">Variable</strong></td><td xmlns="http://www.w3.org/TR/xhtml1/transitional"><strong xmlns="">Value</strong></td><td xmlns="http://www.w3.org/TR/xhtml1/transitional"><strong xmlns="">Reason</strong></td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">AOLserver Username</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">nsadmin</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">AOLserver used to be NaviServer and this was the
        standard username for the server.</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">AOLserver Directory</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">/usr/local/aolserver</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">When you use "make install" AOLserver 3.1
        will be installed here. Note that this is different from previous
        versions of AOLserver; the change conforms to Red Hat Package Manager
        (RPM) specifications.</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">nsadmin Home Directory</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">/home/aol31</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">The various files needed and generated by running
        AOLserver 3.1 processes should be located here, such as server .ini
        and log files. This is described in depth in the next page of the
        install guide.</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">AOLserver Groups</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">nsadmin,web,dba</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">You should have a UNIX group for the server files,
        nsadmin, and a group for the web content, web. Note that in order to
        connect to Oracle using <strong xmlns="">svrmgrl</strong>, your user must be
        part of the <strong xmlns="">dba</strong> group and this capability is needed
        to install the ACS.</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">AOLserver Source Directory</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">/tmp/aolserver</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">This is simply a convenient place to uncompress the
        source.</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">ORACLE_HOME</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">/ora8/m01/app/oracle/product/8.1.6</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">This is the default Oracle installation
        directory.</td></tr></tbody></table></div><p><div align="right" class="cvstag">($Id$)</div></p></div></div><div class="navfooter"><hr size="1" noshade><table width="100%"><tr><td width="40%" align="left"><a class="bottomnav" href="oracle.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a href="mailto:acs-docs@arsdigita.com"><address class="nav">acs-docs@arsdigita.com</address></a></td><td width="40%" align="right">&nbsp;<a class="bottomnav" href="acs.html">Next</a></td></tr></table></div></body></html>
