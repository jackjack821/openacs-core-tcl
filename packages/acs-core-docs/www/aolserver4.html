<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Install AOLserver 4</title><meta name="generator" content="DocBook XSL Stylesheets V1.62.4"><link rel="home" href="index.html" title="OpenACS Core Documentation"><link rel="up" href="complete-install.html" title="Chapter 3. Complete Installation"><link rel="previous" href="aolserver.html" title="Install AOLserver 3.3oacs1"><link rel="next" href="openacs.html" title="Install OpenACS "><link rel="stylesheet" href="openacs.css" type="text/css"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><a href="http://openacs.org"><img src="/doc/images/alex.jpg" border="0"></a><table width="100%" summary="Navigation header" border="0"><tr><td width="20%" align="left"><a accesskey="p" href="aolserver.html">Prev</a> </td><th width="60%" align="center">Chapter 3. Complete Installation</th><td width="20%" align="right"> <a accesskey="n" href="openacs.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aolserver4"></a>Install AOLserver 4</h2></div></div><div></div></div><div class="authorblurb"><p><p>by <a href="mailto:sussdorff@sussdorff.de" target="_top">Malte Sussdorff</a></p><br>
          OpenACS docs are written by the named authors, and may be edited
          by OpenACS documentation staff.
        </p></div><div class="orderedlist"><ol type="1"><li><a name="tcl-download"></a><p><b>Retrieve TCL 8.4 (or higher). </b>Download and install TCL 8.4</p><p>If you have not installed TCL already, download the latest TCL version from Sourceforge</p><pre class="screen">[root root]# <b class="userinput"><tt>cd /usr/local/src</tt></b>
[root src]# <b class="userinput"><tt>wget http://heanet.dl.sourceforge.net/sourceforge/tcl/tcl8.4.5-src.tar.gz</tt></b>
[root src]# <b class="userinput"><tt>tar xfz tcl8.4.5-src.tar.gz</tt></b>
[root src]# <b class="userinput"><tt>cd tcl8.4.5/unix</tt></b>
[root unix]# <b class="userinput"><tt>./configure --enable-threads</tt></b>
[root unix]# <b class="userinput"><tt>make install</tt></b>
[root root]# 
<pre class="action"><span class="action">cd /usr/local/src
wget http://heanet.dl.sourceforge.net/sourceforge/tcl/tcl8.4.5-src.tar.gz
tar xfz tcl8.4.5-src.tar.gz
cd tcl8.4.5/unix
./configure --enable-threads
make install
</span></pre>
      </pre></li><li><a name="aolserver4-download"></a><p><b>Retrieve AOLserver. </b>Download the aolserver from CVS.</p><pre class="screen">[root root]# <b class="userinput"><tt>cd /usr/local/src</tt></b>
[root src]# <b class="userinput"><tt>mkdir aolserver</tt></b>
[root src]# <b class="userinput"><tt>cd aolserver</tt></b>
[root aolserver]# <b class="userinput"><tt>cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co  -r aolserver_v40_r2 aolserver</tt></b>
[root aolserver]# <b class="userinput"><tt>cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nscache</tt></b>
[root aolserver]# <b class="userinput"><tt>cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nsrewrite</tt></b>
[root aolserver]# <b class="userinput"><tt>cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nspostgres</tt></b>
[root aolserver]# <b class="userinput"><tt>cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nssha1</tt></b>
[root aolserver]# <b class="userinput"><tt>cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nsoracle</tt></b>
[root aolserver]# <b class="userinput"><tt>cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nsxml</tt></b>
[root aolserver]# <b class="userinput"><tt>wget http://www.tdom.org/tDOM-0.7.8.tar.gz</tt></b>
[root aolserver]# <b class="userinput"><tt>tar xvfz tDOM-0.7.8.tar.gz</tt></b>
[root root]# 
<pre class="action"><span class="action">cd /usr/local/src
mkdir aolserver
cd aolserver
cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co -r aolserver_v40_r2 aolserver
cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nscache
cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nsrewrite
cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nspostgres
cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nssha1
cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nsoracle
cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/aolserver co nsxml
wget http://www.tdom.org/tDOM-0.7.8.tar.gz
tar xvfz tDOM-0.7.8.tar.gz</span></pre></pre></li><li><a name="aolserver4-install"></a><p><b>Configure, compile and install AOLserver. </b></p><pre class="screen">[root aolserver]# <b class="userinput"><tt>cd aolserver</tt></b>
[root aolserver]# <b class="userinput"><tt>cd aolserver</tt></b>
[root aolserver]# <b class="userinput"><tt>./configure --with-tcl=/usr/local/lib/</tt></b>
[root aolserver]# <b class="userinput"><tt>make install</tt></b></pre></li><li><a name="aolserver4-modules-install"></a><p><b>Configure, compile and install the modules. </b>
          </p><div class="orderedlist"><ol type="a"><li><p><a name="aolserver4-nscache-install"></a>Install nscache</p><pre class="screen">[root /usr/local/src/aolserver/aolserver]# <b class="userinput"><tt>cd ../nscache</tt></b>
[root /usr/local/src/aolserver/nscache]# <b class="userinput"><tt>make install</tt></b></pre></li><li><p><a name="aolserver4-nsrewrite-install"></a>Install nsrewrite</p><pre class="screen">[root /usr/local/src/aolserver/nscache]# <b class="userinput"><tt>cd ../nsrewrite</tt></b>
[root /usr/local/src/aolserver/nsrewrite]# <b class="userinput"><tt>make install</tt></b></pre></li><li><p><a name="aolserver4-nsoracle-install"></a>Install nsoracle (if you want to use Oracle)</p><pre class="screen">[root /usr/local/src/aolserver/nscache]# <b class="userinput"><tt>cd ../nsoracle</tt></b>
[root /usr/local/src/aolserver/nsrewrite]# <b class="userinput"><tt>make install</tt></b></pre><p>Steps so far</p><pre class="screen"><pre class="action"><span class="action">cd /usr/local/src/aolserver/
./configure --with-tcl=/usr/local/lib/
make install
cd ../nscache
make install
cd ../nsrewrite
make install
cd ../nsoracle
make install</span></pre></pre></li><li><p><a name="aolserver4-nspostgres-install"></a>Install nspostgres (if you want to use Postgres)</p><pre class="screen">[root nsrewrite]# <b class="userinput"><tt>cd ../nspostgres</tt></b>
[root nspostgres]# <b class="userinput"><tt>sudo make install POSTGRES=/usr/local/pgsql ACS=1 INST=/usr/local/aolserver </tt></b></pre><p>If you run into problems with libpq.a do the following (and repeat the step above)</p><pre class="screen">[root nspostgres]# <b class="userinput"><tt>sudo ranlib /usr/local/pgsql/lib/libpq.a</tt></b></pre><p>If you run into problems with the linker, edit the Makefile. Add <tt class="computeroutput">-lnsdb</tt> to the <tt class="computeroutput">MODLIBS</tt> var.</p><pre class="programlisting">MODLIBS = -L$(PGLIB) -lpq <span class="bold"><b>-lnsdb</b></span></pre></li><li><p><a name="aolserver4-nssha1-install"></a>Install nssha1</p><pre class="screen">[root nsrewrite]# <b class="userinput"><tt>cd ../nssha1</tt></b>
[root nssha1]# <b class="userinput"><tt>make</tt></b></pre><p>If the make fails you will have to edit nssha1.c. Comment out the following 2 lines (lines 139-140):        </p><pre class="programlisting"><span class="bold"><b>//</b></span> typedef unsigned int u_int32_t;
<span class="bold"><b>//</b></span> typedef unsigned char u_int8_t;</pre><p>Now install nssha1:</p><pre class="screen">[root nssha1]# <b class="userinput"><tt>make install</tt></b></pre></li><li><p><a name="aolserver4-tdom-install"></a>Install tDOM</p><pre class="screen">[root nssha1]# <b class="userinput"><tt>cd ../tDOM-0.7.8/unix</tt></b></pre><p>Edit the <tt class="computeroutput">CONFIG</tt> file. Uncomment the instructions meant for AOLserver 4, but edit it to look like this:</p><pre class="screen">../configure --enable-threads --disable-tdomalloc
          --prefix=/usr/local/aolserver --with-tcl=/usr/local/lib</pre><p>Now you can compile and configure tDOM</p><pre class="screen">[root unix]# <b class="userinput"><tt>sh CONFIG</tt></b>
[root unix]# <b class="userinput"><tt>make install</tt></b></pre></li></ol></div><p>
        </p></li><li><a name="aolserver-db-wrapper"></a><p><b>Add a database-specific wrapper script. </b>This script
	  sets database environment variables before starting
	  AOLserver; this allows the AOLserver instance can
	  communicate with the database.  There is one script each for
	  Oracle and PostgreSQL.  They don't conflict, so if you plan
	  to use both databases, install both.</p><div class="itemizedlist"><ul type="disc"><li><p>Oracle</p><pre class="screen">[root aolserver]# <b class="userinput"><tt>cd /usr/local/aolserver/bin</tt></b>
[root bin]# <b class="userinput"><tt>cp /tmp//packages/acs-core-docs/www/files/nsd-oracle.txt ./nsd-oracle</tt></b>
[root bin]# <b class="userinput"><tt>chmod 750 nsd-oracle</tt></b>
[root bin]#
<pre class="action"><span class="action">cd /usr/local/aolserver/bin
cp /tmp//packages/acs-core-docs/www/files/nsd-oracle.txt ./nsd-oracle
chmod 750 nsd-oracle</span></pre></pre></li><li><p>PostgreSQL</p><pre class="screen">[root aolserver]# <b class="userinput"><tt>cd /usr/local/aolserver/bin</tt></b>
[root bin]# <b class="userinput"><tt>cp /tmp//packages/acs-core-docs/www/files/nsd-postgres.txt ./nsd-postgres</tt></b>
[root bin]# <b class="userinput"><tt>chmod 755 nsd-postgres</tt></b>
[root bin]#
<pre class="action"><span class="action">cd /usr/local/aolserver/bin
cp /tmp//packages/acs-core-docs/www/files/nsd-postgres.txt ./nsd-postgres
chmod 755 nsd-postgres</span></pre></pre></li></ul></div></li><li><p><a href="aolserver.html#install-aolserver-permissions">Test AOLserver</a>.</p></li></ol></div><div class="cvstag">($Id$)</div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="aolserver.html">Prev</a> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right"> <a accesskey="n" href="openacs.html">Next</a></td></tr><tr><td width="40%" align="left">Install AOLserver 3.3oacs1 </td><td width="20%" align="center"><a accesskey="u" href="complete-install.html">Up</a></td><td width="40%" align="right"> Install OpenACS </td></tr></table><hr><address><a href="mailto:docs@openacs.org">docs@openacs.org</a></address></div><a name="comments"></a><center><a href="http://openacs.org/doc/aolserver4.html#comments">View comments on this page at openacs.org</a></center></body></html>
