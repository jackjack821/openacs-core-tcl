<html xmlns:lxslt="http://xml.apache.org/xslt" xmlns:saxon="http://icl.com/saxon" xmlns:xalanredirect="org.apache.xalan.xslt.extensions.Redirect"><head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>9. PL/SQL Standards</title><link rel="stylesheet" href="ad.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.24"><link rel="home" href="index.html" title="ACS Core"><link rel="up" href="eng-standards.html" title="6. Engineering Standards"><link rel="previous" href="eng-standards-filenaming.html" title="8. ACS File Naming and Formatting Standards"><link rel="next" href="kernel-doc.html" title="7. Kernel Documentation"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><a href="http://www.openacs.org/"><img src="images/alex.jpg" border="0"></a><br><br><a class="topnav" href="/">Home</a><span class="topnav"> : </span><a class="topnav" href="index">Documentation</a><span class="topnav"> : </span><a class="topnav" href="acs-dev.html">Part III. For ACS Developers</a><span class="topnav"> : </span><a class="topnav" href="eng-standards.html">6. Engineering Standards</a><span class="topnav"> : </span><strong class="topnav">9. PL/SQL Standards&nbsp;</strong><hr size="1" noshade><div id="eng-standards-plsql" class="sect1"><div class="titlepage"><h2 class="title" style="clear: all"><a name="eng-standards-plsql"></a><span class="label">9.</span> <span class="title">PL/SQL Standards</span></h2></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt>9.1. <a href="eng-standards-plsql.html#eng-standards-plsql-general">General</a></dt><dt>9.2. <a href="eng-standards-plsql.html#eng-standards-plsql-code">Code</a></dt><dt>9.3. <a href="eng-standards-plsql.html#eng-standards-style">Style</a></dt></dl></div><p><p>
By <a href="mailto:richardl@arsdigita.com" target="_top">richardl@arsdigita.com</a>
and <a href="mailto:yon@arsdigita.com" target="_top">yon@arsdigita.com</a>
</p></p><p>
  Like any other part of the ACS, PL/SQL code must be maintainable and
  professional. This means that it must be consistent and therefore
  must abide by certain standards. The standards will ensure that our
  product will be useful long after the current people building and
  maintaining it are around. Following are some standards and
  guidelines that will help us achieve this goal:
</p><div id="eng-standards-plsql-general" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-plsql-general"></a><span class="label">9.1.</span> <span class="title">General</span></h3></div><div class="orderedlist"><ol type="1"><li><a name="N10728"></a><p>
    All PL/SQL code must be well documented. We must write code that
    is maintainable by others, this is especially true in our case
    because we are building an open source toolkit than anyone can
    download and browse the source code. So document like you are
    trying to impress your "Introduction to Programming" professor or
    TA.
   </p></li><li><a name="N10731"></a><p>
    It is important to be consistent throughout an application as much
    as is possible given the nature of team development. This means
    carrying style and other conventions suchs as naming within an
    application, not just within one file.
   </p></li></ol></div></div><div id="eng-standards-plsql-code" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-plsql-code"></a><span class="label">9.2.</span> <span class="title">Code</span></h3></div><div class="orderedlist"><ol type="1"><li><a name="N10741"></a><p>
    Encapsulation of related fuctionality is key to maintainability
    and upgradeability of our software. Try to bundle your code into
    <a href="http://oradoc.photo.net/ora816/appdev.816/a77069/08_packs.htm#4376" target="_top">packages</a>
    whenever possible. This will make upgrading, bug fixing, and
    customizing, among other things, a possibility.
   </p></li><li><a name="N10748"></a><p>
    When creating functions or procedures use the following template,
    it demonstrates most of the guidelines set forth in this document
    that correspond to functions and procedures:
    </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
 
        create or replace procedure|function &lt;proc_or_func_name&gt; (
                 &lt;param_1&gt;    in|out|inout &lt;datatype&gt;,
                 &lt;param_2&gt;    in|out|inout &lt;datatype&gt;,
                 ...
                 &lt;param_n&gt;    in|out|inout &lt;datatype&gt;
        )
        [return &lt;datatype&gt;]
        is
                &lt;local_var_1&gt;    &lt;datatype&gt;
                &lt;local_var_2&gt;    &lt;datatype&gt;
                ...
                &lt;local_var_n&gt;    &lt;datatype&gt;
        begin
                ...
        end &lt;proc_or_func_name&gt;;
        /
        show errors
     
</pre></td></tr></table></blockquote></li><li><a name="N10754"></a><p>
    Always use <tt>create or replace procedure|function
    &lt;proc_or_func_name&gt;</tt>. It makes reloading packages much
    easier and painless to someone who is upgrading or fixing a bug.
   </p></li><li><a name="N10761"></a><p>
    Always qualify <tt>end</tt> statements, i.e., the
    <tt>end</tt> statement for a package should be <tt>end
    &lt;package_name&gt;;</tt>, not just <tt>end;</tt>; same
    goes for procedures, functions, package bodies, and triggers.
   </p></li><li><a name="N10780"></a><p>
    Always use the "show errors" SQL*Plus command after each PL/SQL
    block. It will help you debug when there are compilation errors in
    your PL/SQL code.
   </p></li><li><a name="N10783"></a><p>
    Name parameters as simply as possible, i.e., use the column name
    if the parameter corresponds to a table column. We're deprecating
    the v_* and *_in syntax in favor of named parameters notation:
    </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>

      <tt>
        acs_user.create(first_names =&gt; 'Jane', last_name =&gt; 'Doe', etc.)
      </tt>
        instead of
      <tt>
        acs_user.create(first_names_in =&gt; 'Jane', last_name_in =&gt; 'Doe', etc.)
      </tt>
     
</pre></td></tr></table></blockquote><p>
    To achieve this we must fully qualify arguements passed into
    procedures or functions when using them inside a SQL
    statement. This will get rid of any ambiguities in your code,
    i.e. it will tell the parser when you want the value of the column
    and when you want the value from the local variable. Here is an
    example:
</p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>

        create or replace package body mypackage 
            .
            .
            procedure myproc(party_id in parties.party_id%TYPE) is begin
                .
                .
                delete
                  from parties
                 where party_id = <strong>myproc</strong>.party_id;
                .
                .
            end myproc;
            .
            .
        end mypackage;
        /
        show errors
     
</pre></td></tr></table></blockquote></li><li><a name="N10805"></a><p>
    Explicitly designate each parameter as "in," "out," or "inout."
   </p></li><li><a name="N10808"></a><p>
    Each parameter should be on its own line, with a tab after the
    parameter name, then in/out/inout, then a space, and finally the
    datatype.
   </p></li><li><a name="N10811"></a><p>
    Use %TYPE and %ROWTYPE whenever possible.
   </p></li><li><a name="N10814"></a><p>
    Use 't' and 'f' for booleans, not the PL/SQL "boolean" datatype
    because it can't be used in SQL queries.
   </p></li><li><a name="N10817"></a><p>
    All <tt>new</tt> functions (e.g., <tt>acs_object.new,
    party.new,</tt> etc.) should optionally accept an ID:
    </p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>

      <tt>
        create or replace package acs_object
        as
            function new (
                object_id       in acs_objects.object_id%TYPE default null,
                object_type     in acs_objects.object_type%TYPE default 'acs_object',
	        creation_date   in acs_objects.creation_date%TYPE default sysdate,
                creation_user   in acs_objects.creation_user%TYPE default null,
                creation_ip     in acs_objects.creation_ip%TYPE default null,
                context_id      in acs_objects.context_id%TYPE default null
           ) return acs_objects.object_id%TYPE;
     </tt>
    
</pre></td></tr></table></blockquote><p>
   takes the optional argument <tt>object_id</tt>. Do this to
   allow people to use the same API call when they are doing double
   click protection, that is, tehy have already gotten an
   <tt>object_id</tt> and now they want to create the object with
   that <tt>object_id</tt>.
   </p></li></ol></div></div><div id="eng-standards-style" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-style"></a><span class="label">9.3.</span> <span class="title">Style</span></h3></div><p>
  Some general style guidelines to follow for the purpose of
  consistency across applications.
</p><div class="orderedlist"><ol type="1"><li><a name="N10858"></a><p>
    Standard indentation is 4 spaces. Our PL/SQL code is not only
    viewable in the SQL files but also through our SQL and PL/SQL
    browsers. This means that we should try to make it as consistent
    as possible to all source code readers.
   </p></li><li><a name="N10861"></a><p>
    Lowercase everything, with the exception of %TYPE and %ROWTYPE.
   </p></li></ol></div><p><div align="right" class="cvstag">($Id$)</div></p></div></div><div class="navfooter"><hr size="1" noshade><table width="100%"><tr><td width="40%" align="left"><a class="bottomnav" href="eng-standards-filenaming.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a href="mailto:acs-docs@arsdigita.com"><address class="nav">acs-docs@arsdigita.com</address></a></td><td width="40%" align="right">&nbsp;<a class="bottomnav" href="kernel-doc.html">Next</a></td></tr></table></div></body></html>
