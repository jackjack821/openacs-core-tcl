<html xmlns:lxslt="http://xml.apache.org/xslt" xmlns:saxon="http://icl.com/saxon" xmlns:xalanredirect="org.apache.xalan.xslt.extensions.Redirect"><head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>7. Constraint naming standard</title><link rel="stylesheet" href="ad.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.24"><link rel="home" href="index.html" title="ACS Core"><link rel="up" href="eng-standards.html" title="6. Engineering Standards"><link rel="previous" href="eng-standards-versioning.html" title="6. Release Version Numbering"><link rel="next" href="eng-standards-filenaming.html" title="8. ACS File Naming and Formatting Standards"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><a href="http://www.openacs.org/"><img src="images/alex.jpg" border="0"></a><br><br><a class="topnav" href="/">Home</a><span class="topnav"> : </span><a class="topnav" href="index">Documentation</a><span class="topnav"> : </span><a class="topnav" href="acs-dev.html">Part III. For ACS Developers</a><span class="topnav"> : </span><a class="topnav" href="eng-standards.html">6. Engineering Standards</a><span class="topnav"> : </span><strong class="topnav">7. Constraint naming standard&nbsp;</strong><hr size="1" noshade><div id="eng-standards-constraint-naming" class="sect1"><div class="titlepage"><h2 class="title" style="clear: all"><a name="eng-standards-constraint-naming"></a><span class="label">7.</span> <span class="title">Constraint naming standard</span></h2></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt>7.1. <a href="eng-standards-constraint-naming.html#eng-standards-constraint-naming-big-picture">The Big Picture</a></dt><dt>7.2. <a href="eng-standards-constraint-naming.html#eng-standards-constraint-naming-abbr">Abbreviations</a></dt><dt>7.3. <a href="eng-standards-constraint-naming.html#eng-standards-constraint-naming-format">Format of constraint name</a></dt><dt>7.4. <a href="eng-standards-constraint-naming.html#eng-standards-constraint-naming-example">Example</a></dt><dt>7.5. <a href="eng-standards-constraint-naming.html#eng-standards-constraint-naming-pk">Why it's good to name primary keys</a></dt><dt>7.6. <a href="eng-standards-constraint-naming.html#eng-standards-constraint-naming-nn">Naming not null constraints is optional...</a></dt></dl></div><p><p>By <a href="mailto:mbryzek@arsdigita.com" target="_top">mbryzek@arsdigita.com</a></p></p><div id="eng-standards-constraint-naming-big-picture" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-constraint-naming-big-picture"></a><span class="label">7.1.</span> <span class="title">The Big Picture</span></h3></div><p>
Constraint naming standard is important for one reason: The SYS_* name oracle
assigns to unnamed constraints is not very understandable. By correctly
naming all contraints, we can quickly associate a particular constraint 
with our data model. This gives us two real advantages:
</p><div class="itemizedlist"><ul><li><a name="N10078"></a><p> We can quickly identify and fix any errors. </p></li><li><a name="N10081"></a><p> We can reliabily modify or drop constraints </p></li></ul></div><p>
<strong>Why do we need a naming convention? </strong>
<a href="http://oradoc.photo.net/ora8doc/DOC/server803/A54647_01/ch2.htm#2956" target="_top">Oracle limits names</a>, 
in general, to 30 characters, which is hardly enough for a human readable constraint name.
</p></div><div id="eng-standards-constraint-naming-abbr" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-constraint-naming-abbr"></a><span class="label">7.2.</span> <span class="title">Abbreviations</span></h3></div><p>
We propose the following naming convention for all constraints, with
the following abbreviations taken from Oracle Docs at 
<a href="http://oradoc.photo.net/ora81/DOC/server.815/a67779/ch4e.htm#8953" target="_top">
http://oradoc.photo.net/ora81/DOC/server.815/a67779/ch4e.htm#8953</a>. 
Note that we shortened all of the constraint abbrevations to 
two characters to save room.
</p><div class="informaltable" id="N10103"><a name="N10103"></a><table cellpadding="5" cellspacing="0" border="1"><colgroup><col><col></colgroup><tbody><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional"><strong xmlns="">Constraint type</strong></td><td xmlns="http://www.w3.org/TR/xhtml1/transitional"><strong xmlns="">Abbreviation</strong></td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">references (foreign key)</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">fk</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">unique</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">un</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">primary key</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">pk</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">check</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">ck</td></tr><tr><td xmlns="http://www.w3.org/TR/xhtml1/transitional">not null</td><td xmlns="http://www.w3.org/TR/xhtml1/transitional">nn</td></tr></tbody></table></div></div><div id="eng-standards-constraint-naming-format" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-constraint-naming-format"></a><span class="label">7.3.</span> <span class="title">Format of constraint name</span></h3></div><p>
&lt;table name&gt;_&lt;column_name&gt;_&lt;constraint abbreviation&gt;
</p><p>
In reality, this won't be possible because of the character limitation on 
names inside oracle. When the name is too long, we will follow these two
steps in order:
</p><div class="orderedlist"><ol type="1"><li><a name="N10150"></a><p> Abbreviate the table name with the table's initials (e.g. users -&gt; u and users_contact -&gt; uc).
</p></li><li><a name="N10153"></a><p> Truncate the column name until it fits.</p></li></ol></div><p>
If the constraint name is still too long, you should consider rewriting your
entire data model :)
</p><p><strong>Notes:</strong></p><div class="itemizedlist"><ul><li><a name="N10162"></a><p> If you have to abbreviate the table name for one of the constraints, abbreviate it for all the constraints</p></li><li><a name="N10165"></a><p> If you are defining a multi column constraint, try to truncate the two column names evenly </p></li></ul></div></div><div id="eng-standards-constraint-naming-example" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-constraint-naming-example"></a><span class="label">7.4.</span> <span class="title">Example</span></h3></div><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
create table example_topics (
       topic_id    integer
		   constraint example_topics_topic_id_pk
		   primary key
);

create table constraint_naming_example (
       example_id		      integer
				      constraint cne_example_id_pk
				      primary key,
       one_line_description	      varchar(100)
				      constraint cne_one_line_desc_nn
				      not null,
       body			      clob,
       up_to_date_p		      char(1) default('t')
				      constraint cne_up_to_date_p_check
				      check(up_to_date_p in ('t','f')),
       topic_id			      constraint cne_topic_id_nn not null
				      constraint cne_topic_id_fk references example_topics,
       -- Define table level constraint
       constraint cne_example_id_one_line_unq unique(example_id, one_line_description)
);

</pre></td></tr></table></blockquote></div><div id="eng-standards-constraint-naming-pk" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-constraint-naming-pk"></a><span class="label">7.5.</span> <span class="title">Why it's good to name primary keys</span></h3></div><p>
Naming primary keys might not have any obvious advantages. However, here's an 
example where naming the primary key really helps (and this is by no means
a rare case!
</p><blockquote><table border="0" cellpadding="5" cellspacing="0"><tr><td class="codeblock"><pre>
SQL&gt; set autotrace traceonly explain;


SQL&gt; select * from constraint_naming_example, example_topics 
where constraint_naming_example.topic_id = example_topics.topic_id;

Execution Plan
----------------------------------------------------------
   0	  SELECT STATEMENT Optimizer=CHOOSE
   1	0   NESTED LOOPS
   2	1     TABLE ACCESS (FULL) OF 'CONSTRAINT_NAMING_EXAMPLE'
   3	1     INDEX (UNIQUE SCAN) OF 'EXAMPLE_TOPICS_TOPIC_ID_PK' (UNI
	  QUE)
</pre></td></tr></table></blockquote><p>
Isn't it nice to see "EXAMPLE_TOPICS_TOPIC_ID_PK" in the trace
and know exactly which table oracle is using at each step?
</p></div><div id="eng-standards-constraint-naming-nn" class="sect2"><div class="titlepage"><h3 class="title"><a name="eng-standards-constraint-naming-nn"></a><span class="label">7.6.</span> <span class="title">Naming not null constraints is optional...</span></h3></div><p>
ArsDigita is split on whether or not we should be naming not null constraints... So, if you want to name them, please do so and follow the above naming standard. But, naming not null constraints is not a requirement at ArsDigita.
</p><p>
<strong>About Naming the not null constraints</strong>
</p><p>
Though naming "not null" constraints doesn't help immeditately in error
debugging (e.g. the error will say something like 
"Cannot insert null value into column"), we recommend naming not null
constraints to be consistent in our naming of all constraints.
</p><p><div align="right" class="cvstag">($Id$)</div></p></div></div><div class="navfooter"><hr size="1" noshade><table width="100%"><tr><td width="40%" align="left"><a class="bottomnav" href="eng-standards-versioning.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a href="mailto:acs-docs@arsdigita.com"><address class="nav">acs-docs@arsdigita.com</address></a></td><td width="40%" align="right">&nbsp;<a class="bottomnav" href="eng-standards-filenaming.html">Next</a></td></tr></table></div></body></html>
