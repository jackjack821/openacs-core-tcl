<?xml version='1.0' ?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
               "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd" [

<!ENTITY % myvars SYSTEM "variables.ent">
%myvars;
]>
<appendix id="releasing-openacs">
  <title>How to package and release OpenACS</title>
    <orderedlist>
      <listitem>
        <para>Check out the cvs tree.  The files must be checked out
        through a cvs account with write access.  In this example, the
        cvs user on openacs.org is implied from the ssh login information
        previously set up.  It could be overridden via <computeroutput>foobar@openacs.org</computeroutput>. </para>
        <screen>
<action>cd /tmp
cvs -d :pserver:anonymous@openacs.org:/cvsroot checkout openacs-4
</action>
</screen>
        <para>Repeat with the dotlrn cvs tree.</para>
        <screen>
<action>cd /tmp
mkdir dotlrn-packages
cd dotlrn-packages
cvs -d :pserver:anonymous@dotlrn@openacs.org:/dotlrn-cvsroot checkout dotlrn-all
</action></screen>
      </listitem>
      <listitem>
        <para>Tag the tree.</para>
        <screen><action>
cd /tmp/openacs-4
cvs tag <replaceable>openacs-5-0-0a1</replaceable>
</action></screen>
        <para>Tag dotLRN.  Since the dotLRN packages aren't all in one module, we iterate through all of the modules.  Log in first (cvs login) so that you don't have to log in for each module.</para>
        <screen><action>
cd /tmp/dotlrn-package
for dir in $(ls); do cd $dir; cvs tag <replaceable>dotlrn-2-0-0a3</replaceable>; cd ..; done
</action></screen>
      </listitem>
      <listitem>
        <para>Make the tarball</para>
        <itemizedlist>
          <listitem>
            <formalpara>
              <title>openacs-core</title>
              <para></para>
            </formalpara>
            <orderedlist>
              <listitem>
                <para>Go to a new working space and export the tagged files.</para>
            <screen>
<action>mkdir /tmp/tarball
cd /tmp/tarball
cvs -d :pserver:anonymous@openacs.org:/cvsroot export -r <replaceable>openacs-5-0-0a1</replaceable> -d openacs acs-core
</action></screen>
              </listitem>
              <listitem>
                <para>Generate the tarball</para>
            <screen><action>
cd /tmp/tarball
rm -rf /tmp/tarball/openacs/CVS
tar cz -f <replaceable>openacs-5.0.0a1.tar.gz</replaceable> openacs
</action></screen>
              </listitem>
            </orderedlist>
          </listitem>
          <listitem>
            <formalpara>
              <title>dotlrn</title>
              <para></para>
            </formalpara>
            <orderedlist>
              <listitem>
                <para>Go to a new working space and export the tagged
                files. (was getting errors here trying to use -d, so
                gave up and just moved things from openacs-4 to
                openacs at the end)</para>
            <screen>
<action>mkdir /tmp/dotlrn-tarball
cd /tmp/dotlrn-tarball
cvs -d :pserver:anonymous@openacs.org:/cvsroot export \
  -r <replaceable>openacs-5-0-0a1</replaceable> acs-core
cd /tmp/dotlrn-tarball/openacs-4/packages
cvs -d :pserver:anonymous@openacs.org:/cvsroot export \
  -r <replaceable>openacs-5-0-0a1</replaceable> dotlrn-prereq
cvs -d :pserver:anonymous@dotlrn.openacs.org:/dotlrn-cvsroot export \
  -r <replaceable>dotlrn-2-0-0a1</replaceable> dotlrn-core
cd /tmp/dotlrn-tarball
mv openacs-4 openacs
</action></screen>
              </listitem>
              <listitem>
                <para>Copy the dotlrn install.xml file, which controls
                which packages are installed on setup, to the root
                location:</para>
                <screen><action>
cp /tmp/dotlrn-tarball/openacs-4/packages/dotlrn/install.xml /tmp/dotlrn-tarball/openacs
</action></screen>
              </listitem>


              <listitem>
                <para>Generate the tarball</para>
            <screen><action>
cd /tmp/tarball
rm -rf /tmp/tarball/openacs-4/CVS
tar cz -f <replaceable>dotlrn-2.0.0a1.tar.gz</replaceable> openacs
</action></screen>
              </listitem>
            </orderedlist>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>Test the new tarball</para>
      </listitem>
      <listitem>
        <para>Update on the site</para>
      </listitem>
    </orderedlist>
  </appendix>
