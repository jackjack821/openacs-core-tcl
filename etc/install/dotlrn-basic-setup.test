if { [catch {
    source tcl/test-procs.tcl

    # Test Execution START
        
    ::twt::util::log "Login the site wide admin"
    ::twt::user::login_site_wide_admin
    
    ::twt::util::log "Add the site wide admin to dotLRN"
    ::twt::dotlrn::add_site_wide_admin $server_url
    
    ::twt::util::log "Upload users"
    ::twt::user::upload_users $server_url

    ::twt::util::log "Set up terms"
    ::twt::dotlrn::setup_terms $server_url
    
    ::twt::util::log "Set up departments"
    ::twt::dotlrn::setup_departments $server_url
    
    ::twt::util::log "Set up subjects"
    ::twt::dotlrn::setup_subjects $server_url
    
    ::twt::util::log "Set up classes"
    ::twt::dotlrn::setup_classes $server_url
    
    ::twt::util::log "Set up communities (i.e. Tennis Club etc.)"
    ::twt::dotlrn::setup_communities $server_url    
    
    ::twt::util::log "Add class members, i.e. professors, students and assistants"
    ::twt::class::setup_memberships $server_url
    
    ::twt::util::log "Add class subgroups"
    ::twt::class::setup_subgroups $server_url
    
    ::twt::util::log "Add class member applet"    
    ::twt::class::add_member_applets $server_url
    
    ::twt::util::log "Set up class forums - one per class"
    ::twt::forums::add_default_forums $server_url
    
    ::twt::util::log "Add forum postings"
    ::twt::forums::add_postings 
    
    ::twt::util::log "Add news items - one per class"
    ::twt::news::add_item_to_classes $server_url

    # Test Execution END

} result] } {
    global errorInfo

    # Output error stack trace and HTML response body
    puts stderr $result
    puts stderr "*** Tcl TRACE ***"
    puts stderr $errorInfo
    puts "The response body is: [response body]"

    error "Test failed: $result"
}
